import requests
from bs4 import BeautifulSoup
import os

sessionId="XXXX" #put session id here

headers = {'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',
'Accept-Encoding': 'gzip, deflate, br',
'Accept-Language': 'en-US,en;q=0.5',
'Cache-Control': 'max-age=0',
'Connection': 'keep-alive',
'Cookie':f'MoodleSession={sessionId}; _gat=1',
'Host': 'lionel2.kgv.edu.hk',
'If-Modified-Since':'Wed, 26 Jan 2022 21:05:40 GMT',
'If-None-Match':"96ca96156b3a3c907a0a19359e2168a80229e900",
'Sec-Fetch-Dest':'document',
'Sec-Fetch-Mode':'navigate',
'Sec-Fetch-Site':'cross-site',
'Sec-Fetch-User':'?1',
'Upgrade-Insecure-Requests': '1',
'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0'}

link='https://lionel2.kgv.edu.hk/user/index.php?contextid=61452&roleid=0&id=3980&perpage=2000&search=&mode=0'

page=requests.get(link,headers=headers)

soup = BeautifulSoup(page.text, 'html.parser')

images = soup.find_all('img')[1:] #gets all images, names are stored in alt
ids = soup.find_all('a')

print(ids)

data=open('General-Scrapers/data.txt','w',encoding='utf-8')

s=soup.prettify()

data.write(s)

# names=[]
# x=soup.find_all('a')
# for item in x:
#     if item.string:
#         names.append(item.string.strip())

# photoids=[]
# imgs=soup.find_all('img')
# for image in imgs:
#     photoids.append(image['src'])